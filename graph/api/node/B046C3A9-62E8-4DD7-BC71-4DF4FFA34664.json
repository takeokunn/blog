{
  "id": "B046C3A9-62E8-4DD7-BC71-4DF4FFA34664",
  "title": "Typstとpdfpcでプレゼン機能を実現する",
  "raw": ":PROPERTIES:\n:ID:       B046C3A9-62E8-4DD7-BC71-4DF4FFA34664\n:END:\n#+TITLE: Typstとpdfpcでプレゼン機能を実現する\n#+AUTHOR: takeokunn\n#+DESCRIPTION: description\n#+DATE: 2025-06-08T14:52:33+0900\n#+HUGO_BASE_DIR: ../../\n#+HUGO_CATEGORIES: fleeting\n#+HUGO_SECTION: posts/fleeting\n#+HUGO_TAGS: fleeting typst\n#+HUGO_DRAFT: false\n#+STARTUP: fold\n* 背景・動機\n\nTypstでスライドを作るフローがだいぶ固まってきた。\n\n- [[id:0D13FCEA-F8EC-4729-B700-9A88FD1D5EB9][NixでTypstをBuildしGitHub Pagesでホスティングする]]\n- [[id:C6F8F599-5F2A-4C8C-8148-0DF03644CE35][Typstテーマを自作した]]\n- [[id:9A373386-769A-4152-BDED-20931CA588BC][Typst自作テーマで登壇スライドを作成した]]\n\n過去に普段資料はGoogle Slideで作成していたのだが、次の理由でGoogle Slideを使っていた。\n\n例: [[https://docs.google.com/presentation/d/1_vOdQO0SY671SRQpnpEz1xvVyUy-Vzl_Dk4Ph6ujy84/edit?slide=id.p#slide=id.p][AWS SQSとLaravelで大規模トラフィックを捌く - phpcon新潟]]\n\n- Google Driveで管理できる\n- 自己紹介部分など過去のスライドを流用できる\n- 文字や画像の配置に自由度がある\n- プレゼンター表示ができる\n  - スピーカーノートを別画面で確認できる\n  - 経過時間の計測ができる\n\n管理方法やスライドに関するものはTypst力が上がればカバーできるが、プレゼンター表示に関しては何か対策を講じなければ代替できない。\n\n今回は実際に登壇に耐えうるツールの選定と運用の検討をしたのでメモしておく。\n\n* 試したこと・やったこと\n** 0. ツールの選定\n\n自分がプレゼンテーションモードに求めている機能をリストアップすると以下。\n\n- MUST\n  - 登壇スライドとは別にスピーカーノートを別画面で確認できる\n  - 経過時間の計測ができる\n  - Typst内 or Orgファイル内でスピーカーノートを管理できる\n- SHOULD\n  - 次スライドの表示\n  - 全体のスライド表示\n- MAY\n  - ホワイトボード／ペンツール機能\n  - オフラインで機能する\n  - 動画やスライドアニメーションなどの制御\n\nTypstから生成したPDFをそのままプレゼン資料として表示できるツールは無数にある。\n\n- [[https://www.apple.com/jp/keynote/][Keynote]]\n- [[https://www.microsoft.com/ja-jp/microsoft-365/powerpoint][PowerPoint]]\n- [[https://github.com/Cimbali/pympress][Pympress]]\n- etc..\n\n[[id:C6F8F599-5F2A-4C8C-8148-0DF03644CE35][Typstテーマを自作した]] にも書いたとおり、Typstのベーステーマに [[https://polylux.dev/book/polylux.html][polylux]] を利用している。\n\npolyluxのドキュメントを読んでいるとpdfpcと繋ぎ込む記述があり、これを用いるとスピーカーノートを実現できることが分かる。\n可能な限り公式がサポートしているものを使う方が筋がよい、また要件を十分に満たしていることが確認が取れたので今回は[[https://pdfpc.github.io/][pdfpc]]を選択した。\n\nhttps://polylux.dev/book/external/pdfpc.html#pdfpc\n\n** 1. Typstとpdfpcとの繋ぎ込み\n\npdfpc integrationは [[https://github.com/polylux-typ/polylux][polylux-typ/polylux]] の [[https://github.com/polylux-typ/polylux/blob/c58e89c890c397eb300e1a144e6c88b5b2851399/src/toolbox/pdfpc.typ][src/toolbox/pdfpc.typ]] にある。\n使い方は簡単で、次のように記述するだけでよい。\n\n#+begin_src typst\n  #import \"@preview/polylux:0.4.0\": *\n\n  #slide[\n      #toolbox.pdfpc.speaker-note(\"This is a note that only the speaker will see.\")\n  ]\n#+end_src\n\n[[https://search.nixos.org/packages?channel=25.05&show=polylux2pdfpc&from=0&size=50&sort=relevance&type=packages&query=polylux2pdfpc][polylux2pdfpc]]を使ってpdfpcファイルを生成する。\n\n#+begin_src bash\n  # PDFを生成\n  $ typst compile foo.typ\n\n  # pdfpcを生成\n  $ polylux2pdfpc foo.typ\n#+end_src\n\n=foo.pdfpc= が生成される。\n\n#+begin_src json\n  {\n    \"pdfpcFormat\": 2,\n    \"disableMarkdown\": false,\n    \"pages\": [\n      {\n        \"idx\": 0,\n        \"label\": 1,\n        \"overlay\": 0,\n        \"forcedOverlay\": false,\n        \"hidden\": false,\n        \"note\": \"This is a note that only the speaker will see.\"\n      },\n      {\n        \"idx\": 1,\n        \"label\": 2,\n        \"overlay\": 0,\n        \"forcedOverlay\": false,\n        \"hidden\": false\n      },\n      {\n        \"idx\": 2,\n        \"label\": 3,\n        \"overlay\": 0,\n        \"forcedOverlay\": false,\n        \"hidden\": false\n      },\n      {\n        \"idx\": 3,\n        \"label\": 4,\n        \"overlay\": 0,\n        \"forcedOverlay\": false,\n        \"hidden\": false\n      },\n      {\n        \"idx\": 4,\n        \"label\": 5,\n        \"overlay\": 0,\n        \"forcedOverlay\": false,\n        \"hidden\": false\n      },\n      {\n        \"idx\": 5,\n        \"label\": 6,\n        \"overlay\": 0,\n        \"forcedOverlay\": false,\n        \"hidden\": false\n      },\n      {\n        \"idx\": 7,\n        \"label\": 7,\n        \"overlay\": 0,\n        \"forcedOverlay\": false,\n        \"hidden\": false\n      }\n    ]\n  }\n#+end_src\n\nなお私はNixユーザなのでflake.nixで記述している。\n\nhttps://github.com/takeokunn/blog/blob/8416672d96853732b5bf97c77586beab9bd4051f/typst/flake.nix#L59-L77\n\n** 2. pdfpcインストール\n\npdfpcはnixpkgsにあるのでインストールが簡単だが、手元のM1 Macだと次のようなエラーが出て入らなかった。\n\nhttps://search.nixos.org/packages?channel=25.05&show=pdfpc&from=0&size=50&sort=relevance&type=packages&query=pdfpc\n\n#+begin_src console\n  error: Package ‘webkitgtk-2.48.2+abi=4.1’ in /nix/store/dzwwydggypqg4p8r6if5zdaqyzhsxjkd-source/pkgs/development/libraries/webkitgtk/default.nix:254 is marked as broken, refusing to evaluate.\n#+end_src\n\nhomebrewにもパッケージがあるのでこちらから入れた。\n\nhttps://formulae.brew.sh/formula/pdfpc\n\n次のようにコマンドを叩いて生成したpdfpcファイルと共にpdfを指定するとビューワーが起動した。\n\n複数モニタにしてから起動すると手元PCには管理側の画像、外部モニターにはPDFが全画面で表示された。\n\n#+begin_src console\n  $ /opt/homebrew/bin/pdfpc result/foo.pdf -R result/foo.pdfpc\n#+end_src\n\n[[file:../../static/images/10CAB95D-C307-46B7-BDBA-29E0D9085FA3.png]]\n\n** 3. pdfpcの使い方確認\n\n[[https://qiita.com/s417-lama/items/9f332abf55710b4688b5][マスタリングpdfpc - Qiita]] に操作方法が詳細に記述してある。\n\n手元のM1 Macの場合は微妙にキーバインドが違うのか期待とおり動いてくれなかったので要練習。\n\n- =j/k= で次のスライドに移動できない\n- ポインタやお絵描きのキーバインドが異なる\n\n=?= で画面上でkeybindを確認できるようだ。\n\n[[file:../../static/images/DA6E03AC-6232-4B94-82C0-ABA25F6ED732.png]]\n\n* 得られた結果・所感\n\n当初の目標であるGoogle Slideの脱却が今回の対応で可能になったのは個人的に大きい。\npdfpcの使い方に関しては登壇を通じて練習していきたい。\n\n* 今後の展開・検討事項\n\n登壇の場数を踏んでより洗練させていきたい。\n登壇周りのすべてがプレーンテキスト（Org）で管理できるようになったので、次はAIによるスライド生成にチャレンジしたい。\n",
  "backlinks": [
    {
      "title": "AIを駆使してTypstスライドを生成する",
      "source": "A442DBE9-559A-4B75-AAF3-4A925F5BA5E4"
    }
  ]
}