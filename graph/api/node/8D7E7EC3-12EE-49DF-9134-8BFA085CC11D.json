{
  "id": "8D7E7EC3-12EE-49DF-9134-8BFA085CC11D",
  "title": "org-nix-shell入門",
  "raw": ":PROPERTIES:\n:ID:       8D7E7EC3-12EE-49DF-9134-8BFA085CC11D\n:END:\n#+TITLE: org-nix-shell入門\n#+AUTHOR: takeokunn\n#+DESCRIPTION: description\n#+DATE: 2025-02-08T11:00:00+0900\n#+HUGO_BASE_DIR: ../../\n#+HUGO_CATEGORIES: fleeting\n#+HUGO_SECTION: posts/fleeting\n#+HUGO_TAGS: fleeting nix\n#+HUGO_DRAFT: false\n#+STARTUP: fold\n* Introduction\n\norg-nix-shellはOrg関連パッケージの中でもキラーアプリケーションと呼べるもので、個人的に今熱いパッケージのひとつです。\n簡単な使い方と実際のユースケースを紹介していきます。\n\n* インストール\n\n- GitHub: https://github.com/AntonHakansson/org-nix-shell/blob/main/README.org\n- melpa: https://melpa.org/#/org-nix-shell\n\nMelpa経由で入れてもよいし、GitHub経由で直接インストールしてもよい。\n次のように設定するだけで機能してくれる。\n\n#+begin_src emacs-lisp\n  (require 'org-nix-shell)\n\n  (with-eval-after-load 'org\n    (add-hook 'org-mode-hook #'org-nix-shell-mode))\n#+end_src\n* 使い方\n** Basic\n\n次のようにNixを定義して =:nix-shell= で読み込む。\n\n#+begin_src org\n  ,#+name: tmp-shell\n  ,#+BEGIN_SRC nix :noweb yes\n    { pkgs ? import <nixpkgs> { } }:\n    pkgs.mkShell { buildInputs = with pkgs; [ php ]; }\n    ,#+END_SRC\n\n  ,#+begin_src shell :nix-shell tmp-shell :results output\n    php --version\n  ,#+end_src\n#+end_src\n\nまた、次のURLから古いバージョンを取ってきて実行することも可能。\nhttps://lazamar.co.uk/nix-versions\n\n#+begin_src org\n  ,#+name: php74-shell\n  ,#+BEGIN_SRC nix :noweb yes\n    let\n      url =\n        \"https://github.com/NixOS/nixpkgs/archive/4426104c8c900fbe048c33a0e6f68a006235ac50.tar.gz\";\n      pkgs = import (builtins.fetchTarball { inherit url; }) {\n        system = \"<<wandbox-system>>\";\n      };\n    in pkgs.mkShell { buildInputs = with pkgs; [ php74 ]; }\n  ,#+END_SRC\n\n  ,#+begin_src php :nix-shell php74-shell :exports both\n    echo phpversion();\n  ,#+end_src\n\n  ,#+RESULTS:\n  : 7.4.4\n#+end_src\n\nproperty指定もできる。\n\nBuffer Scope:\n\n#+begin_src org\n  ,#+property: header-args: :nix-shell <name>\n#+end_src\n\nSubtree Scope:\n\n#+begin_src org\n  ,* sample header\n    :PROPERTIES:\n    :header-args: :nix-shell <name>\n    :END:\n#+end_src\n** Adviced\n\n複数の処理系を定義しておけば、wandboxのようなことも実現可能になる。\nhttps://github.com/takeokunn/blog/blob/main/static/snippets/wandbox.org\n\n* 所感\n必要なものを明示的にインストールして実行できるのでポータビリティが非常に高い。\nブログや運用手順書との相性が非常に良く、文芸的プログラミングのレベルをひとつ上にレベルアップすることが可能になった。\n",
  "backlinks": [
    {
      "title": "credential管理をorg-encryptからpassword-storeに移行した",
      "source": "8A0AAFA0-0FDA-4C4C-BDC3-8279A68CE44C"
    }
  ]
}