{
  "id": "F17E4F3A-9AC7-4BE4-B7E1-6D6CB1496BA1",
  "title": "Neovimの設定をNixvimに移行した",
  "raw": ":PROPERTIES:\n:ID:       F17E4F3A-9AC7-4BE4-B7E1-6D6CB1496BA1\n:END:\n#+TITLE: Neovimの設定をNixvimに移行した\n#+AUTHOR: takeokunn\n#+DESCRIPTION: description\n#+DATE: 2025-12-25T06:48:38+0900\n#+HUGO_BASE_DIR: ../../\n#+HUGO_CATEGORIES: fleeting\n#+HUGO_SECTION: posts/fleeting\n#+HUGO_TAGS: fleeting nix neovim\n#+HUGO_DRAFT: false\n#+STARTUP: fold\n* 背景・動機\n\n私はEmacsユーザだが、最近同僚エンジニアが全員Neovimユーザの会社に転職してしまった。\nよい機会だしある程度Neovimを使えた方がいいなと思い、Neovimをひととおり設定したのでメモしておく。\n\n* 試したこと・やったこと\n** 1. 管理方法選定\n\n次のニーズを満たすものを探していた。\n\n- 普段メインで触らないので塩漬ビリティの高い状態にする\n- lua scriptは可能なら書きたくない、期間が開くとどうせ忘れる\n- AIに書かせても動くことを保証しやすい状態にする\n- プラグイン管理と設定が近い状態にする\n\nNixにないかなと調査してた所、[[https://github.com/nix-community/nixvim][Nixvim]] を使えば上記の要件を満たせることがわかったので導入してみた。\n\n余談だが公式ドキュメントは情報量が少ないのでソースコードを読んだ方がいい。\n\nhttps://nix-community.github.io/nixvim/index.html\n\n** 2. 初期構築\n\nインストールガイドなどを参考に導入する。\n\nhttps://nix-community.github.io/nixvim/user-guide/install.html\n\nflake.nixで設定する。\n\n#+begin_src nix\n  {\n    inputs = {\n      nixvim = {\n        url = \"github:nix-community/nixvim\";\n        inputs.nixpkgs.follows = \"nixpkgs\";\n      };\n    };\n  }\n\n#+end_src\n\nhome-managerのsharedModulesで読み込む。\n\n#+begin_src nix\n  nix-darwin.lib.darwinSystem {\n    modules = [\n      home-manager.darwinModules.home-manager\n      {\n        home-manager = {\n          sharedModules = [ nixvim.homeModules.nixvim ];\n        };\n      }\n    ];\n  }\n#+end_src\n\nあとはNixvimを有効にするだけ。\n\n#+begin_src nix\n  {\n    programs.nixvim = {\n      enable = true;\n\n      colorschemes.catppuccin.enable = true;\n      plugins.lualine.enable = true;\n    };\n  }\n#+end_src\n\n** 3. AIに設定させる\n\nあとは好みの設定をするだけ。\n\nhttps://github.com/takeokunn/nixos-configuration/tree/main/home-manager/programs/nixvim\n\nこの記事を書いてる時点では、次のようなディレクトリ構造で用意してる。\nあまり何も考えずに「モダンなプラグインを入れて」とClaude Codeに指示して書かせてる。\n\n#+begin_src console\n  $ pwd\n  /Users/take/ghq/github.com/takeokunn/nixos-configuration/home-manager/programs/nixvim\n\n  $ nix run nixpkgs#tree .\n  .\n  |-- default.nix\n  |-- globals\n  |   `-- default.nix\n  |-- keymaps\n  |   |-- basic.nix\n  |   |-- default.nix\n  |   `-- window.nix\n  |-- modules\n  |   |-- oil-git-status.nix\n  |   |-- skkeleton.nix\n  |   `-- vim-sandwich.nix\n  |-- opts\n  |   |-- default.nix\n  |   |-- display.nix\n  |   |-- editing.nix\n  |   |-- performance.nix\n  |   `-- search.nix\n  |-- packages\n  |   `-- default.nix\n  `-- plugins\n      |-- core\n      |   |-- editing.nix\n      |   `-- file-explorer.nix\n      |-- default.nix\n      |-- language\n      |   |-- japanese.nix\n      |   |-- lsp.nix\n      |   |-- markdown.nix\n      |   |-- rust.nix\n      |   |-- treesitter.nix\n      |   `-- web.nix\n      |-- tools\n      |   |-- git.nix\n      |   |-- harpoon.nix\n      |   |-- misc.nix\n      |   `-- telescope.nix\n      `-- ui\n          |-- bufferline.nix\n          |-- dashboard.nix\n          |-- icons.nix\n          |-- navigation.nix\n          |-- notifications.nix\n          |-- statusline.nix\n          `-- visual-aids.nix\n\n  11 directories, 34 files\n#+end_src\n\nNeovimやLuaや事情は分からないが、 =performance.byteCompileLua= でByte Compileしてくれるみたいなので有効にできるようだ。\nNeovimのプラグイン事情はよくわからないのでいったんすべてのプラグインをLua製に統一させた。\n\n#+begin_src nix\n  {\n    programs.nixvim = {\n      luaLoader.enable = true;\n      performance.byteCompileLua = {\n        enable = true;\n        nvimRuntime = true;\n        configs = true;\n        plugins = true;\n      };\n    };\n  }\n#+end_src\n* 得られた結果・所感\n\nモダンなエディタくらいの操作感になったし、安定的に動いてくれるようになった。\n既存のNixの更新サイクルにも乗るようになったので、毎日最新のプラグインが入って確実に動くNeovimを使えるフローが固まった。\n\n[[file:../../static/images/7CC4F84F-6F57-4036-AED9-E0FAD965E3B5.png]]\n\n* 今後の展開・検討事項\n\nNeovim環境がかなり整ったので普段の開発でもNeovimを積極的に使いたい。\n",
  "backlinks": []
}