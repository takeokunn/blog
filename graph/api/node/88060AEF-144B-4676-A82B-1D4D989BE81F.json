{
  "id": "88060AEF-144B-4676-A82B-1D4D989BE81F",
  "title": "Docker VolumeをCopy/Renameする方法",
  "raw": ":PROPERTIES:\n:ID:       88060AEF-144B-4676-A82B-1D4D989BE81F\n:mtime:    20231204002920\n:ctime:    20230209111810\n:END:\n#+TITLE: Docker VolumeをCopy/Renameする方法\n#+AUTHOR: takeokunn\n#+DESCRIPTION: Docker VolumeをCopy/Renameする方法\n#+DATE: 2023-02-09T09:00:00+09:00\n#+HUGO_BASE_DIR: ../../\n#+HUGO_SECTION: posts/fleeting\n#+HUGO_CATEGORIES: fleeting\n#+HUGO_TAGS: docker\n#+HUGO_DRAFT: false\n#+STARTUP: fold\n* 前提\n\n=docker volume= のデフォルトの機能にcopyやrenameはありません。\nhttps://matsuand.github.io/docs.docker.jp.onthefly/storage/volumes/\n\n[[https://github.com/moby/moby/issues/31154][Rename docker volume #31154]] というissueも立っているが、対応される見込がないです。\n\ninterfaceとして提供してくれていないだけで、実態はDocker File System内どこかにはあるはず。\n絶対できるはずだという前提のもと調べてみたらできたのでまとめておきます。\n\n* 準備\n\n~docker engine~ を起動して、 ~docker volume~ を作成する。\n\n#+begin_src shell\n  docker volume create --name=my-volume\n#+end_src\n\n* CopyやRenameのやり方\n\n~justincormack/nsenter1~ を立ち上げる。\n\n#+begin_src shell\n  docker run -it --rm --privileged --pid=host justincormack/nsenter1\n#+end_src\n\n~docker volume~ がある場所に移動する。\n\n#+begin_src shell\n  / # cd /var/lib/docker/volumes/\n\n  /var/lib/docker/volumes # ls -la | grep my-volume\n  drwx-----x    3 root     root          4096 Feb  9 02:59 my-volume\n#+end_src\n\nあとは ~cp~ をするなり、 ~mv~ をするなりでよしなに。\n\nすぐに認識してくれないみたいなので ~Docker for Mac~ に反映するには再起動が必要そう。\n",
  "backlinks": []
}