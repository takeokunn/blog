{
  "id": "8F655307-A5CF-4101-84C8-4A85887E8B7C",
  "title": "markdown-preview-modeとxwidgetsでリアルタイムプレビューする",
  "raw": ":PROPERTIES:\n:ID:       8F655307-A5CF-4101-84C8-4A85887E8B7C\n:END:\n#+TITLE: markdown-preview-modeとxwidgetsでリアルタイムプレビューする\n#+AUTHOR: takeokunn\n#+DESCRIPTION: description\n#+DATE: 2025-05-10T18:40:29+0900\n#+HUGO_BASE_DIR: ../../\n#+HUGO_CATEGORIES: fleeting\n#+HUGO_SECTION: posts/fleeting\n#+HUGO_TAGS: fleeting emacs\n#+HUGO_DRAFT: false\n#+STARTUP: fold\n* 背景・動機\n\n最近AIが生成したMarkdownを読む機会が増えた。\nEmacs Buffer上で読むのもよいのだが、ブラウザ上でCSSを当てた方が読みやすいので今回対応した。\n\n* 試したこと・やったこと\n** 1. markdown-preview-modeを用意する\n\n- [[https://github.com/ancane/markdown-preview-mode][ancane/markdown-preview-mode]] をインストールする\n  - Melpa経由で入る\n- Markdownをコンパイルする為に [[https://pandoc.org/][pandoc]] を用意する\n\n** 2. markdown-preview-modeの設定をする\n\nsolarized-lightのテーマを選んだ。\n\n#+begin_src emacs-lisp\n  (setq markdown-preview-stylesheets (list \"http://thomasf.github.io/solarized-css/solarized-light.min.css\"))\n#+end_src\n\n既存のテーマで画像を表示すると表示ずれ発生するのでスタイルを上書きした。\n\n#+begin_src emacs-lisp\n  (defun my/markdown-preview-css-filter (orig-return)\n    (concat orig-return \"<style>img { max-width: 100%; }</style>\"))\n\n  (advice-add 'markdown-preview--css :filter-return #'my/markdown-preview-css-filter)\n#+end_src\n\npreviewを起動する時にxwidget経由で開くようにした。\n\n#+begin_src emacs-lisp\n  (defun my/markdown-preview--start-with-xwidget (orig-fun &rest args)\n    (let ((browse-url-browser-function #'xwidget-webkit-browse-url))\n      (apply orig-fun args)))\n\n  (advice-add 'markdown-preview--start :around #'my/markdown-preview--start-with-xwidget)\n#+end_src\n* 得られた結果・所感\n\n他エディタに遜色ないくらい体験が良くなった。\nWebSocket Serverも立ててくれるのでリアルタイムプレビューも可能になった。\n\n[[file:../../static/images/294497E0-19F6-44FD-8664-826BF09039CF.png]]\n\n* 今後の展開・検討事項\n\norg-modeの場合は [[https://github.com/jakebox/org-preview-html][org-preview-html]] で実現できるのでxwidget対応をする。\n",
  "backlinks": []
}