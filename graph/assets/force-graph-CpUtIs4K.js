import{i as en,T as ze,a as Pe,t as te}from"./transform-x-kuN-PY.js";import{s as B,d as nn,a as pn}from"./isObjectLike-DZOcISe9.js";import{p as re,d as yn,t as mn,i as tn,s as vn,a as N,f as xn,b as bn,c as wn,e as _n,g as kn,h as Cn,G as zn,T as Ie,E as Le}from"./radial-DQiyJWH2.js";import{o as Pn}from"./ordinal-Cboi1Yqb.js";import{m as Fe,a as Ne}from"./min-tv6RD-6E.js";import{g as Ge}from"./index-DVcZB_95.js";import"./colors-Cc3OSVma.js";import"./toNumber-CMwwYzW2.js";import"./isSymbol-CPMUUYKH.js";import"./init-Gi6I4Gst.js";function On(r,e){let n=0;for(let i of r)(i=+i)&&(n+=i);return n}const En={passive:!1},ve={capture:!0,passive:!1};function Oe(r){r.stopImmediatePropagation()}function le(r){r.preventDefault(),r.stopImmediatePropagation()}function rn(r){var e=r.document.documentElement,n=B(r).on("dragstart.drag",le,ve);"onselectstart"in e?n.on("selectstart.drag",le,ve):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function on(r,e){var n=r.document.documentElement,i=B(r).on("dragstart.drag",null);e&&(i.on("click.drag",le,ve),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const be=r=>()=>r;function Ae(r,{sourceEvent:e,subject:n,target:i,identifier:o,active:u,x:a,y:s,dx:c,dy:f,dispatch:h}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:h}})}Ae.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function Dn(r){return!r.ctrlKey&&!r.button}function Mn(){return this.parentNode}function Tn(r,e){return e??{x:r.x,y:r.y}}function An(){return navigator.maxTouchPoints||"ontouchstart"in this}function Sn(){var r=Dn,e=Mn,n=Tn,i=An,o={},u=nn("start","drag","end"),a=0,s,c,f,h,l=0;function d(v){v.on("mousedown.drag",p).filter(i).on("touchstart.drag",C).on("touchmove.drag",m,En).on("touchend.drag touchcancel.drag",T).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(v,w){if(!(h||!r.call(this,v,w))){var E=A(this,e.call(this,v,w),v,w,"mouse");E&&(B(v.view).on("mousemove.drag",y,ve).on("mouseup.drag",k,ve),rn(v.view),Oe(v),f=!1,s=v.clientX,c=v.clientY,E("start",v))}}function y(v){if(le(v),!f){var w=v.clientX-s,E=v.clientY-c;f=w*w+E*E>l}o.mouse("drag",v)}function k(v){B(v.view).on("mousemove.drag mouseup.drag",null),on(v.view,f),le(v),o.mouse("end",v)}function C(v,w){if(r.call(this,v,w)){var E=v.changedTouches,_=e.call(this,v,w),P=E.length,M,O;for(M=0;M<P;++M)(O=A(this,_,v,w,E[M].identifier,E[M]))&&(Oe(v),O("start",v,E[M]))}}function m(v){var w=v.changedTouches,E=w.length,_,P;for(_=0;_<E;++_)(P=o[w[_].identifier])&&(le(v),P("drag",v,w[_]))}function T(v){var w=v.changedTouches,E=w.length,_,P;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),_=0;_<E;++_)(P=o[w[_].identifier])&&(Oe(v),P("end",v,w[_]))}function A(v,w,E,_,P,M){var O=u.copy(),U=re(M||E,w),I,L,g;if((g=n.call(v,new Ae("beforestart",{sourceEvent:E,target:d,identifier:P,active:a,x:U[0],y:U[1],dx:0,dy:0,dispatch:O}),_))!=null)return I=g.x-U[0]||0,L=g.y-U[1]||0,function z(x,D,S){var R=U,j;switch(x){case"start":o[P]=z,j=a++;break;case"end":delete o[P],--a;case"drag":U=re(S||D,w),j=a;break}O.call(x,v,new Ae(x,{sourceEvent:D,subject:g,target:d,identifier:P,active:j,x:U[0]+I,y:U[1]+L,dx:U[0]-R[0],dy:U[1]-R[1],dispatch:O}),_)}}return d.filter=function(v){return arguments.length?(r=typeof v=="function"?v:be(!!v),d):r},d.container=function(v){return arguments.length?(e=typeof v=="function"?v:be(v),d):e},d.subject=function(v){return arguments.length?(n=typeof v=="function"?v:be(v),d):n},d.touchable=function(v){return arguments.length?(i=typeof v=="function"?v:be(!!v),d):i},d.on=function(){var v=u.on.apply(u,arguments);return v===u?d:v},d.clickDistance=function(v){return arguments.length?(l=(v=+v)*v,d):Math.sqrt(l)},d}var Rn=1e-12;function $e(r){return((r=Math.exp(r))+1/r)/2}function jn(r){return((r=Math.exp(r))-1/r)/2}function Un(r){return((r=Math.exp(2*r))-1)/(r+1)}const In=(function r(e,n,i){function o(u,a){var s=u[0],c=u[1],f=u[2],h=a[0],l=a[1],d=a[2],p=h-s,y=l-c,k=p*p+y*y,C,m;if(k<Rn)m=Math.log(d/f)/e,C=function(_){return[s+_*p,c+_*y,f*Math.exp(e*_*m)]};else{var T=Math.sqrt(k),A=(d*d-f*f+i*k)/(2*f*n*T),v=(d*d-f*f-i*k)/(2*d*n*T),w=Math.log(Math.sqrt(A*A+1)-A),E=Math.log(Math.sqrt(v*v+1)-v);m=(E-w)/e,C=function(_){var P=_*m,M=$e(w),O=f/(n*T)*(M*Un(e*P+w)-jn(w));return[s+O*p,c+O*y,f*M/$e(e*P+w)]}}return C.duration=m*1e3*e/Math.SQRT2,C}return o.rho=function(u){var a=Math.max(.001,+u),s=a*a,c=s*s;return r(a,s,c)},o})(Math.SQRT2,2,4),we=r=>()=>r;function Ln(r,{sourceEvent:e,target:n,transform:i,dispatch:o}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function Ee(r){r.stopImmediatePropagation()}function ce(r){r.preventDefault(),r.stopImmediatePropagation()}function Fn(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function Nn(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function qe(){return this.__zoom||en}function Gn(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function $n(){return navigator.maxTouchPoints||"ontouchstart"in this}function qn(r,e,n){var i=r.invertX(e[0][0])-n[0][0],o=r.invertX(e[1][0])-n[1][0],u=r.invertY(e[0][1])-n[0][1],a=r.invertY(e[1][1])-n[1][1];return r.translate(o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o),a>u?(u+a)/2:Math.min(0,u)||Math.max(0,a))}function Vn(){var r=Fn,e=Nn,n=qn,i=Gn,o=$n,u=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,c=In,f=nn("start","zoom","end"),h,l,d,p=500,y=150,k=0,C=10;function m(g){g.property("__zoom",qe).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",O).filter(o).on("touchstart.zoom",U).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(g,z,x,D){var S=g.selection?g.selection():g;S.property("__zoom",qe),g!==S?w(g,z,x,D):S.interrupt().each(function(){E(this,arguments).event(D).start().zoom(null,typeof z=="function"?z.apply(this,arguments):z).end()})},m.scaleBy=function(g,z,x,D){m.scaleTo(g,function(){var S=this.__zoom.k,R=typeof z=="function"?z.apply(this,arguments):z;return S*R},x,D)},m.scaleTo=function(g,z,x,D){m.transform(g,function(){var S=e.apply(this,arguments),R=this.__zoom,j=x==null?v(S):typeof x=="function"?x.apply(this,arguments):x,F=R.invert(j),G=typeof z=="function"?z.apply(this,arguments):z;return n(A(T(R,G),j,F),S,a)},x,D)},m.translateBy=function(g,z,x,D){m.transform(g,function(){return n(this.__zoom.translate(typeof z=="function"?z.apply(this,arguments):z,typeof x=="function"?x.apply(this,arguments):x),e.apply(this,arguments),a)},null,D)},m.translateTo=function(g,z,x,D,S){m.transform(g,function(){var R=e.apply(this,arguments),j=this.__zoom,F=D==null?v(R):typeof D=="function"?D.apply(this,arguments):D;return n(en.translate(F[0],F[1]).scale(j.k).translate(typeof z=="function"?-z.apply(this,arguments):-z,typeof x=="function"?-x.apply(this,arguments):-x),R,a)},D,S)};function T(g,z){return z=Math.max(u[0],Math.min(u[1],z)),z===g.k?g:new ze(z,g.x,g.y)}function A(g,z,x){var D=z[0]-x[0]*g.k,S=z[1]-x[1]*g.k;return D===g.x&&S===g.y?g:new ze(g.k,D,S)}function v(g){return[(+g[0][0]+ +g[1][0])/2,(+g[0][1]+ +g[1][1])/2]}function w(g,z,x,D){g.on("start.zoom",function(){E(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(D).end()}).tween("zoom",function(){var S=this,R=arguments,j=E(S,R).event(D),F=e.apply(S,R),G=x==null?v(F):typeof x=="function"?x.apply(S,R):x,V=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),q=S.__zoom,Y=typeof z=="function"?z.apply(S,R):z,Q=c(q.invert(G).concat(V/q.k),Y.invert(G).concat(V/Y.k));return function(K){if(K===1)K=Y;else{var J=Q(K),Ce=V/J[2];K=new ze(Ce,G[0]-J[0]*Ce,G[1]-J[1]*Ce)}j.zoom(null,K)}})}function E(g,z,x){return!x&&g.__zooming||new _(g,z)}function _(g,z){this.that=g,this.args=z,this.active=0,this.sourceEvent=null,this.extent=e.apply(g,z),this.taps=0}_.prototype={event:function(g){return g&&(this.sourceEvent=g),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(g,z){return this.mouse&&g!=="mouse"&&(this.mouse[1]=z.invert(this.mouse[0])),this.touch0&&g!=="touch"&&(this.touch0[1]=z.invert(this.touch0[0])),this.touch1&&g!=="touch"&&(this.touch1[1]=z.invert(this.touch1[0])),this.that.__zoom=z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(g){var z=B(this.that).datum();f.call(g,this.that,new Ln(g,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:f}),z)}};function P(g,...z){if(!r.apply(this,arguments))return;var x=E(this,z).event(g),D=this.__zoom,S=Math.max(u[0],Math.min(u[1],D.k*Math.pow(2,i.apply(this,arguments)))),R=re(g);if(x.wheel)(x.mouse[0][0]!==R[0]||x.mouse[0][1]!==R[1])&&(x.mouse[1]=D.invert(x.mouse[0]=R)),clearTimeout(x.wheel);else{if(D.k===S)return;x.mouse=[R,D.invert(R)],Pe(this),x.start()}ce(g),x.wheel=setTimeout(j,y),x.zoom("mouse",n(A(T(D,S),x.mouse[0],x.mouse[1]),x.extent,a));function j(){x.wheel=null,x.end()}}function M(g,...z){if(d||!r.apply(this,arguments))return;var x=g.currentTarget,D=E(this,z,!0).event(g),S=B(g.view).on("mousemove.zoom",G,!0).on("mouseup.zoom",V,!0),R=re(g,x),j=g.clientX,F=g.clientY;rn(g.view),Ee(g),D.mouse=[R,this.__zoom.invert(R)],Pe(this),D.start();function G(q){if(ce(q),!D.moved){var Y=q.clientX-j,Q=q.clientY-F;D.moved=Y*Y+Q*Q>k}D.event(q).zoom("mouse",n(A(D.that.__zoom,D.mouse[0]=re(q,x),D.mouse[1]),D.extent,a))}function V(q){S.on("mousemove.zoom mouseup.zoom",null),on(q.view,D.moved),ce(q),D.event(q).end()}}function O(g,...z){if(r.apply(this,arguments)){var x=this.__zoom,D=re(g.changedTouches?g.changedTouches[0]:g,this),S=x.invert(D),R=x.k*(g.shiftKey?.5:2),j=n(A(T(x,R),D,S),e.apply(this,z),a);ce(g),s>0?B(this).transition().duration(s).call(w,j,D,g):B(this).call(m.transform,j,D,g)}}function U(g,...z){if(r.apply(this,arguments)){var x=g.touches,D=x.length,S=E(this,z,g.changedTouches.length===D).event(g),R,j,F,G;for(Ee(g),j=0;j<D;++j)F=x[j],G=re(F,this),G=[G,this.__zoom.invert(G),F.identifier],S.touch0?!S.touch1&&S.touch0[2]!==G[2]&&(S.touch1=G,S.taps=0):(S.touch0=G,R=!0,S.taps=1+!!h);h&&(h=clearTimeout(h)),R&&(S.taps<2&&(l=G[0],h=setTimeout(function(){h=null},p)),Pe(this),S.start())}}function I(g,...z){if(this.__zooming){var x=E(this,z).event(g),D=g.changedTouches,S=D.length,R,j,F,G;for(ce(g),R=0;R<S;++R)j=D[R],F=re(j,this),x.touch0&&x.touch0[2]===j.identifier?x.touch0[0]=F:x.touch1&&x.touch1[2]===j.identifier&&(x.touch1[0]=F);if(j=x.that.__zoom,x.touch1){var V=x.touch0[0],q=x.touch0[1],Y=x.touch1[0],Q=x.touch1[1],K=(K=Y[0]-V[0])*K+(K=Y[1]-V[1])*K,J=(J=Q[0]-q[0])*J+(J=Q[1]-q[1])*J;j=T(j,Math.sqrt(K/J)),F=[(V[0]+Y[0])/2,(V[1]+Y[1])/2],G=[(q[0]+Q[0])/2,(q[1]+Q[1])/2]}else if(x.touch0)F=x.touch0[0],G=x.touch0[1];else return;x.zoom("touch",n(A(j,F,G),x.extent,a))}}function L(g,...z){if(this.__zooming){var x=E(this,z).event(g),D=g.changedTouches,S=D.length,R,j;for(Ee(g),d&&clearTimeout(d),d=setTimeout(function(){d=null},p),R=0;R<S;++R)j=D[R],x.touch0&&x.touch0[2]===j.identifier?delete x.touch0:x.touch1&&x.touch1[2]===j.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(j=re(j,this),Math.hypot(l[0]-j[0],l[1]-j[1])<C)){var F=B(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return m.wheelDelta=function(g){return arguments.length?(i=typeof g=="function"?g:we(+g),m):i},m.filter=function(g){return arguments.length?(r=typeof g=="function"?g:we(!!g),m):r},m.touchable=function(g){return arguments.length?(o=typeof g=="function"?g:we(!!g),m):o},m.extent=function(g){return arguments.length?(e=typeof g=="function"?g:we([[+g[0][0],+g[0][1]],[+g[1][0],+g[1][1]]]),m):e},m.scaleExtent=function(g){return arguments.length?(u[0]=+g[0],u[1]=+g[1],m):[u[0],u[1]]},m.translateExtent=function(g){return arguments.length?(a[0][0]=+g[0][0],a[1][0]=+g[1][0],a[0][1]=+g[0][1],a[1][1]=+g[1][1],m):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},m.constrain=function(g){return arguments.length?(n=g,m):n},m.duration=function(g){return arguments.length?(s=+g,m):s},m.interpolate=function(g){return arguments.length?(c=g,m):c},m.on=function(){var g=f.on.apply(f,arguments);return g===f?m:g},m.clickDistance=function(g){return arguments.length?(k=(g=+g)*g,m):Math.sqrt(k)},m.tapDistance=function(g){return arguments.length?(C=+g,m):C},m}var Wn="Expected a function";function Hn(r,e,n){var i=!0,o=!0;if(typeof r!="function")throw new TypeError(Wn);return pn(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),yn(r,e,{leading:i,maxWait:e,trailing:o})}function Se(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function Zn(r){if(Array.isArray(r))return Se(r)}function an(r,e,n){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function Xn(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yn(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function H(r,e){return r.get(an(r,e))}function Ve(r,e,n){Xn(r,e),e.set(r,n)}function We(r,e,n){return r.set(an(r,e),n),n}function Kn(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,tt(i.key),i)}}function Bn(r,e,n){return e&&Kn(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Qn(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Jn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function et(r){return Zn(r)||Qn(r)||rt(r)||Jn()}function nt(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function tt(r){var e=nt(r,"string");return typeof e=="symbol"?e:e+""}function rt(r,e){if(r){if(typeof r=="string")return Se(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(r,e):void 0}}var it=123,ot=function(e){return"#".concat(Math.min(e,Math.pow(2,24)).toString(16).padStart(6,"0"))},un=function(e,n,i){return(e<<16)+(n<<8)+i},at=function(e){var n=mn(e).toRgb(),i=n.r,o=n.g,u=n.b;return un(i,o,u)},He=function(e,n){return e*it%Math.pow(2,n)},ae=new WeakMap,ee=new WeakMap,ut=(function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;Yn(this,r),Ve(this,ae,void 0),Ve(this,ee,void 0),We(ee,this,e),this.reset()}return Bn(r,[{key:"reset",value:function(){We(ae,this,["__reserved for background__"])}},{key:"register",value:function(n){if(H(ae,this).length>=Math.pow(2,24-H(ee,this)))return null;var i=H(ae,this).length,o=He(i,H(ee,this)),u=ot(i+(o<<24-H(ee,this)));return H(ae,this).push(n),u}},{key:"lookup",value:function(n){if(!n)return null;var i=typeof n=="string"?at(n):un.apply(void 0,et(n));if(!i)return null;var o=i&Math.pow(2,24-H(ee,this))-1,u=i>>24-H(ee,this)&Math.pow(2,H(ee,this))-1;return He(o,H(ee,this))!==u||o>=H(ae,this).length?null:H(ae,this)[o]}}])})();const{abs:fe,cos:ne,sin:ue,acos:st,atan2:he,sqrt:ie,pow:Z}=Math;function de(r){return r<0?-Z(-r,1/3):Z(r,1/3)}const sn=Math.PI,_e=2*sn,oe=sn/2,lt=1e-6,De=Number.MAX_SAFE_INTEGER||9007199254740991,Me=Number.MIN_SAFE_INTEGER||-9007199254740991,ct={x:0,y:0,z:0},b={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const n=e(r);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),ie(i)},compute:function(r,e,n){if(r===0)return e[0].t=0,e[0];const i=e.length-1;if(r===1)return e[i].t=1,e[i];const o=1-r;let u=e;if(i===0)return e[0].t=r,e[0];if(i===1){const s={x:o*u[0].x+r*u[1].x,y:o*u[0].y+r*u[1].y,t:r};return n&&(s.z=o*u[0].z+r*u[1].z),s}if(i<4){let s=o*o,c=r*r,f,h,l,d=0;i===2?(u=[u[0],u[1],u[2],ct],f=s,h=o*r*2,l=c):i===3&&(f=s*o,h=s*r*3,l=o*c*3,d=r*c);const p={x:f*u[0].x+h*u[1].x+l*u[2].x+d*u[3].x,y:f*u[0].y+h*u[1].y+l*u[2].y+d*u[3].y,t:r};return n&&(p.z=f*u[0].z+h*u[1].z+l*u[2].z+d*u[3].z),p}const a=JSON.parse(JSON.stringify(e));for(;a.length>1;){for(let s=0;s<a.length-1;s++)a[s]={x:a[s].x+(a[s+1].x-a[s].x)*r,y:a[s].y+(a[s+1].y-a[s].y)*r},typeof a[s].z<"u"&&(a[s].z=a[s].z+(a[s+1].z-a[s].z)*r);a.splice(a.length-1,1)}return a[0].t=r,a[0]},computeWithRatios:function(r,e,n,i){const o=1-r,u=n,a=e;let s=u[0],c=u[1],f=u[2],h=u[3],l;if(s*=o,c*=r,a.length===2)return l=s+c,{x:(s*a[0].x+c*a[1].x)/l,y:(s*a[0].y+c*a[1].y)/l,z:i?(s*a[0].z+c*a[1].z)/l:!1,t:r};if(s*=o,c*=2*o,f*=r*r,a.length===3)return l=s+c+f,{x:(s*a[0].x+c*a[1].x+f*a[2].x)/l,y:(s*a[0].y+c*a[1].y+f*a[2].y)/l,z:i?(s*a[0].z+c*a[1].z+f*a[2].z)/l:!1,t:r};if(s*=o,c*=1.5*o,f*=3*o,h*=r*r*r,a.length===4)return l=s+c+f+h,{x:(s*a[0].x+c*a[1].x+f*a[2].x+h*a[3].x)/l,y:(s*a[0].y+c*a[1].y+f*a[2].y+h*a[3].y)/l,z:i?(s*a[0].z+c*a[1].z+f*a[2].z+h*a[3].z)/l:!1,t:r}},derive:function(r,e){const n=[];for(let i=r,o=i.length,u=o-1;o>1;o--,u--){const a=[];for(let s=0,c;s<u;s++)c={x:u*(i[s+1].x-i[s].x),y:u*(i[s+1].y-i[s].y)},e&&(c.z=u*(i[s+1].z-i[s].z)),a.push(c);n.push(a),i=a}return n},between:function(r,e,n){return e<=r&&r<=n||b.approximately(r,e)||b.approximately(r,n)},approximately:function(r,e,n){return fe(r-e)<=(n||lt)},length:function(r){const n=b.Tvalues.length;let i=0;for(let o=0,u;o<n;o++)u=.5*b.Tvalues[o]+.5,i+=b.Cvalues[o]*b.arcfn(u,r);return .5*i},map:function(r,e,n,i,o){const u=n-e,a=o-i,s=r-e,c=s/u;return i+a*c},lerp:function(r,e,n){const i={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+r*(n.z-e.z)),i},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(b.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,n){const i=e.x-r.x,o=e.y-r.y,u=n.x-r.x,a=n.y-r.y,s=i*a-o*u,c=i*u+o*a;return he(s,c)},round:function(r,e){const n=""+r,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(r,e){const n=r.x-e.x,i=r.y-e.y;return ie(n*n+i*i)},closest:function(r,e){let n=Z(2,63),i,o;return r.forEach(function(u,a){o=b.dist(e,u),o<n&&(n=o,i=a)}),{mdist:n,mpos:i}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=Z(r,e)+Z(1-r,e),i=n-1;return fe(i/n)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=Z(1-r,e),i=Z(r,e)+n;return n/i},lli8:function(r,e,n,i,o,u,a,s){const c=(r*i-e*n)*(o-a)-(r-n)*(o*s-u*a),f=(r*i-e*n)*(u-s)-(e-i)*(o*s-u*a),h=(r-n)*(u-s)-(e-i)*(o-a);return h==0?!1:{x:c/h,y:f/h}},lli4:function(r,e,n,i){const o=r.x,u=r.y,a=e.x,s=e.y,c=n.x,f=n.y,h=i.x,l=i.y;return b.lli8(o,u,a,s,c,f,h,l)},lli:function(r,e){return b.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new $(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=De,n=De,i=Me,o=Me;return r.forEach(function(u){const a=u.bbox();e>a.x.min&&(e=a.x.min),n>a.y.min&&(n=a.y.min),i<a.x.max&&(i=a.x.max),o<a.y.max&&(o=a.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+o)/2,max:o,size:o-n}}},shapeintersections:function(r,e,n,i,o){if(!b.bboxoverlap(e,i))return[];const u=[],a=[r.startcap,r.forward,r.back,r.endcap],s=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(c){c.virtual||s.forEach(function(f){if(f.virtual)return;const h=c.intersects(f,o);h.length>0&&(h.c1=c,h.c2=f,h.s1=r,h.s2=n,u.push(h))})}),u},makeshape:function(r,e,n){const i=e.points.length,o=r.points.length,u=b.makeline(e.points[i-1],r.points[0]),a=b.makeline(r.points[o-1],e.points[0]),s={startcap:u,forward:r,back:e,endcap:a,bbox:b.findbbox([u,r,e,a])};return s.intersections=function(c){return b.shapeintersections(s,s.bbox,c,c.bbox,n)},s},getminmax:function(r,e,n){if(!n)return{min:0,max:0};let i=De,o=Me,u,a;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let s=0,c=n.length;s<c;s++)u=n[s],a=r.get(u),a[e]<i&&(i=a[e]),a[e]>o&&(o=a[e]);return{min:i,mid:(i+o)/2,max:o,size:o-i}},align:function(r,e){const n=e.p1.x,i=e.p1.y,o=-he(e.p2.y-i,e.p2.x-n),u=function(a){return{x:(a.x-n)*ne(o)-(a.y-i)*ue(o),y:(a.x-n)*ue(o)+(a.y-i)*ne(o)}};return r.map(u)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=r.length-1,i=b.align(r,e),o=function(_){return 0<=_&&_<=1};if(n===2){const _=i[0].y,P=i[1].y,M=i[2].y,O=_-2*P+M;if(O!==0){const U=-ie(P*P-_*M),I=-_+P,L=-(U+I)/O,g=-(-U+I)/O;return[L,g].filter(o)}else if(P!==M&&O===0)return[(2*P-M)/(2*P-2*M)].filter(o);return[]}const u=i[0].y,a=i[1].y,s=i[2].y,c=i[3].y;let f=-u+3*a-3*s+c,h=3*u-6*a+3*s,l=-3*u+3*a,d=u;if(b.approximately(f,0)){if(b.approximately(h,0))return b.approximately(l,0)?[]:[-d/l].filter(o);const _=ie(l*l-4*h*d),P=2*h;return[(_-l)/P,(-l-_)/P].filter(o)}h/=f,l/=f,d/=f;const p=(3*l-h*h)/3,y=p/3,k=(2*h*h*h-9*h*l+27*d)/27,C=k/2,m=C*C+y*y*y;let T,A,v,w,E;if(m<0){const _=-p/3,P=_*_*_,M=ie(P),O=-k/(2*M),U=O<-1?-1:O>1?1:O,I=st(U),L=de(M),g=2*L;return v=g*ne(I/3)-h/3,w=g*ne((I+_e)/3)-h/3,E=g*ne((I+2*_e)/3)-h/3,[v,w,E].filter(o)}else{if(m===0)return T=C<0?de(-C):-de(C),v=2*T-h/3,w=-T-h/3,[v,w].filter(o);{const _=ie(m);return T=de(-C+_),A=de(C+_),[T-A-h/3].filter(o)}}},droots:function(r){if(r.length===3){const e=r[0],n=r[1],i=r[2],o=e-2*n+i;if(o!==0){const u=-ie(n*n-e*i),a=-e+n,s=-(u+a)/o,c=-(-u+a)/o;return[s,c]}else if(n!==i&&o===0)return[(2*n-i)/(2*(n-i))];return[]}if(r.length===2){const e=r[0],n=r[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(r,e,n,i,o){let u,a,s,c,f=0,h=0;const l=b.compute(r,e),d=b.compute(r,n),p=l.x*l.x+l.y*l.y;if(i?(u=ie(Z(l.y*d.z-d.y*l.z,2)+Z(l.z*d.x-d.z*l.x,2)+Z(l.x*d.y-d.x*l.y,2)),a=Z(p+l.z*l.z,3/2)):(u=l.x*d.y-l.y*d.x,a=Z(p,3/2)),u===0||a===0)return{k:0,r:0};if(f=u/a,h=a/u,!o){const y=b.curvature(r-.001,e,n,i,!0).k,k=b.curvature(r+.001,e,n,i,!0).k;c=(k-f+(f-y))/2,s=(fe(k-f)+fe(f-y))/2}return{k:f,r:h,dk:c,adk:s}},inflections:function(r){if(r.length<4)return[];const e=b.align(r,{p1:r[0],p2:r.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,o=e[1].x*e[2].y,u=e[3].x*e[2].y,a=18*(-3*n+2*i+3*o-u),s=18*(3*n-i-3*o),c=18*(o-n);if(b.approximately(a,0)){if(!b.approximately(s,0)){let d=-c/s;if(0<=d&&d<=1)return[d]}return[]}const f=2*a;if(b.approximately(f,0))return[];const h=s*s-4*a*c;if(h<0)return[];const l=Math.sqrt(h);return[(l-s)/f,-(s+l)/f].filter(function(d){return 0<=d&&d<=1})},bboxoverlap:function(r,e){const n=["x","y"],i=n.length;for(let o=0,u,a,s,c;o<i;o++)if(u=n[o],a=r[u].mid,s=e[u].mid,c=(r[u].size+e[u].size)/2,fe(a-s)>=c)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,n){const i=r.bbox(),o=e.bbox(),u=1e5,a=n||.5;if(i.x.size+i.y.size<a&&o.x.size+o.y.size<a)return[(u*(r._t1+r._t2)/2|0)/u+"/"+(u*(e._t1+e._t2)/2|0)/u];let s=r.split(.5),c=e.split(.5),f=[{left:s.left,right:c.left},{left:s.left,right:c.right},{left:s.right,right:c.right},{left:s.right,right:c.left}];f=f.filter(function(l){return b.bboxoverlap(l.left.bbox(),l.right.bbox())});let h=[];return f.length===0||(f.forEach(function(l){h=h.concat(b.pairiteration(l.left,l.right,a))}),h=h.filter(function(l,d){return h.indexOf(l)===d})),h},getccenter:function(r,e,n){const i=e.x-r.x,o=e.y-r.y,u=n.x-e.x,a=n.y-e.y,s=i*ne(oe)-o*ue(oe),c=i*ue(oe)+o*ne(oe),f=u*ne(oe)-a*ue(oe),h=u*ue(oe)+a*ne(oe),l=(r.x+e.x)/2,d=(r.y+e.y)/2,p=(e.x+n.x)/2,y=(e.y+n.y)/2,k=l+s,C=d+c,m=p+f,T=y+h,A=b.lli8(l,d,k,C,p,y,m,T),v=b.dist(A,r);let w=he(r.y-A.y,r.x-A.x),E=he(e.y-A.y,e.x-A.x),_=he(n.y-A.y,n.x-A.x),P;return w<_?((w>E||E>_)&&(w+=_e),w>_&&(P=_,_=w,w=P)):_<E&&E<w?(P=_,_=w,w=P):_+=_e,A.s=w,A.e=_,A.r=v,A},numberSort:function(r,e){return r-e}};class ye{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return b.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)b.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new ye(n)}}const{abs:ge,min:Ze,max:Xe,cos:ft,sin:ht,acos:dt,sqrt:pe}=Math,gt=Math.PI;class ${constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const p=[];n.forEach(function(y){["x","y","z"].forEach(function(k){typeof y[k]<"u"&&p.push(y[k])})}),n=p}let o=!1;const u=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");o=!0}}else if(u!==6&&u!==8&&u!==9&&u!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const a=this._3d=!o&&(u===9||u===12)||e&&e[0]&&typeof e[0].z<"u",s=this.points=[];for(let p=0,y=a?3:2;p<u;p+=y){var c={x:n[p],y:n[p+1]};a&&(c.z=n[p+2]),s.push(c)}const f=this.order=s.length-1,h=this.dims=["x","y"];a&&h.push("z"),this.dimlen=h.length;const l=b.align(s,{p1:s[0],p2:s[f]}),d=b.dist(s[0],s[f]);this._linear=l.reduce((p,y)=>p+ge(y.y),0)<d/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,o){if(typeof o>"u"&&(o=.5),o===0)return new $(n,n,i);if(o===1)return new $(e,n,n);const u=$.getABC(2,e,n,i,o);return new $(e,u.A,i)}static cubicFromPoints(e,n,i,o,u){typeof o>"u"&&(o=.5);const a=$.getABC(3,e,n,i,o);typeof u>"u"&&(u=b.dist(n,a.C));const s=u*(1-o)/o,c=b.dist(e,i),f=(i.x-e.x)/c,h=(i.y-e.y)/c,l=u*f,d=u*h,p=s*f,y=s*h,k={x:n.x-l,y:n.y-d},C={x:n.x+p,y:n.y+y},m=a.A,T={x:m.x+(k.x-m.x)/(1-o),y:m.y+(k.y-m.y)/(1-o)},A={x:m.x+(C.x-m.x)/o,y:m.y+(C.y-m.y)/o},v={x:e.x+(T.x-e.x)/o,y:e.y+(T.y-e.y)/o},w={x:i.x+(A.x-i.x)/(1-o),y:i.y+(A.y-i.y)/(1-o)};return new $(e,v,w,i)}static getUtils(){return b}getUtils(){return $.getUtils()}static get PolyBezier(){return ye}valueOf(){return this.toString()}toString(){return b.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,o=["M",n,i,this.order===2?"Q":"C"];for(let u=1,a=e.length;u<a;u++)o.push(e[u].x),o.push(e[u].y);return o.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=b.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=b.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return b.length(this.derivative.bind(this))}static getABC(e=2,n,i,o,u=.5){const a=b.projectionratio(u,e),s=1-a,c={x:a*n.x+s*o.x,y:a*n.y+s*o.y},f=b.abcratio(u,e);return{A:{x:i.x+(i.x-c.x)/f,y:i.y+(i.y-c.y)/f},B:i,C:c,S:n,E:o}}getABC(e,n){n=n||this.get(e);let i=this.points[0],o=this.points[this.order];return $.getABC(this.order,i,n,o,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,o;n<e;n++)o=n/(e-1),i=this.compute(o),i.t=o,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),o=[];for(let u=0,a,s=0;u<i.length;u++)a=i[u],b.dist(a,e)<n&&(o.push(a),s+=u/i.length);return o.length?t/=o.length:!1}project(e){const n=this.getLUT(),i=n.length-1,o=b.closest(n,e),u=o.mpos,a=(u-1)/i,s=(u+1)/i,c=.1/i;let f=o.mdist,h=a,l=h,d;f+=1;for(let p;h<s+c;h+=c)d=this.compute(h),p=b.dist(e,d),p<f&&(f=p,l=h);return l=l<0?0:l>1?1:l,d=this.compute(l),d.t=l,d.d=f,d}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?b.computeWithRatios(e,this.points,this.ratios,this._3d):b.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let o=1,u,a;o<i;o++)u=e[o],a=e[o-1],n[o]={x:(i-o)/i*u.x+o/i*a.x,y:(i-o)/i*u.y+o/i*a.y};return n[i]=e[i-1],new $(n)}derivative(e){return b.compute(e,this.dpoints[0],this._3d)}dderivative(e){return b.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new $(b.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return b.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return b.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=pe(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),o=pe(n.x*n.x+n.y*n.y+n.z*n.z),u=pe(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=o,n.y/=o,n.z/=o,i.x/=u,i.y/=u,i.z/=u;const a={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},s=pe(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=s,a.y/=s,a.z/=s;const c=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:e,x:c[0]*n.x+c[1]*n.y+c[2]*n.z,y:c[3]*n.x+c[4]*n.y+c[5]*n.z,z:c[6]*n.x+c[7]*n.y+c[8]*n.z}}hull(e){let n=this.points,i=[],o=[],u=0;for(o[u++]=n[0],o[u++]=n[1],o[u++]=n[2],this.order===3&&(o[u++]=n[3]);n.length>1;){i=[];for(let a=0,s,c=n.length-1;a<c;a++)s=b.lerp(e,n[a],n[a+1]),o[u++]=s,i.push(s);n=i}return o}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),o={left:this.order===2?new $([i[0],i[3],i[5]]):new $([i[0],i[4],i[7],i[9]]),right:this.order===2?new $([i[5],i[4],i[2]]):new $([i[9],i[8],i[6],i[3]]),span:i};return o.left._t1=b.map(0,0,1,this._t1,this._t2),o.left._t2=b.map(e,0,1,this._t1,this._t2),o.right._t1=b.map(e,0,1,this._t1,this._t2),o.right._t2=b.map(1,0,1,this._t1,this._t2),n?(n=b.map(n,e,1,0,1),o.right.split(n).left):o}extrema(){const e={};let n=[];return this.dims.forEach((function(i){let o=function(a){return a[i]},u=this.dpoints[0].map(o);e[i]=b.droots(u),this.order===3&&(u=this.dpoints[1].map(o),e[i]=e[i].concat(b.droots(u))),e[i]=e[i].filter(function(a){return a>=0&&a<=1}),n=n.concat(e[i].sort(b.numberSort))}).bind(this)),e.values=n.sort(b.numberSort).filter(function(i,o){return n.indexOf(i)===o}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=b.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return b.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),o=this.normal(e),u={c:i,n:o,x:i.x+o.x*n,y:i.y+o.y*n};return this._3d&&(u.z=i.z+o.z*n),u}if(this._linear){const i=this.normal(0),o=this.points.map(function(u){const a={x:u.x+e*i.x,y:u.y+e*i.y};return u.z&&i.z&&(a.z=u.z+e*i.z),a});return[new $(o)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const o=b.angle(this.points[0],this.points[3],this.points[1]),u=b.angle(this.points[0],this.points[3],this.points[2]);if(o>0&&u<0||o<0&&u>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),ge(dt(i))<gt/3}reduce(){let e,n=0,i=0,o=.01,u,a=[],s=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),n=c[0],e=1;e<c.length;e++)i=c[e],u=this.split(n,i),u._t1=n,u._t2=i,a.push(u),n=i;return a.forEach(function(f){for(n=0,i=0;i<=1;)for(i=n+o;i<=1+o;i+=o)if(u=f.split(n,i),!u.simple()){if(i-=o,ge(n-i)<o)return[];u=f.split(n,i),u._t1=b.map(n,0,1,f._t1,f._t2),u._t2=b.map(i,0,1,f._t1,f._t2),s.push(u),n=i;break}n<1&&(u=f.split(n,1),u._t1=b.map(n,0,1,f._t1,f._t2),u._t2=f._t2,s.push(u))}),s}translate(e,n,i){i=typeof i=="number"?i:n;const o=this.order;let u=this.points.map((a,s)=>(1-s/o)*n+s/o*i);return new $(this.points.map((a,s)=>({x:a.x+e.x*u[s],y:a.y+e.y*u[s]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const o=this.clockwise,u=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const a=i?i(0):e,s=i?i(1):e,c=[this.offset(0,10),this.offset(1,10)],f=[],h=b.lli4(c[0],c[0].c,c[1],c[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(l){const d=f[l*n]=b.copy(u[l*n]);d.x+=(l?s:a)*c[l].n.x,d.y+=(l?s:a)*c[l].n.y}),i?([0,1].forEach(function(l){if(!(n===2&&l)){var d=u[l+1],p={x:d.x-h.x,y:d.y-h.y},y=i?i((l+1)/n):e;i&&!o&&(y=-y);var k=pe(p.x*p.x+p.y*p.y);p.x/=k,p.y/=k,f[l+1]={x:d.x+y*p.x,y:d.y+y*p.y}}}),new $(f)):([0,1].forEach(l=>{if(n===2&&l)return;const d=f[l*n],p=this.derivative(l),y={x:d.x+p.x,y:d.y+p.y};f[l+1]=b.lli4(d,y,h,u[l+1])}),new $(f))}outline(e,n,i,o){if(n=n===void 0?e:n,this._linear){const w=this.normal(0),E=this.points[0],_=this.points[this.points.length-1];let P,M,O;i===void 0&&(i=e,o=n),P={x:E.x+w.x*e,y:E.y+w.y*e},O={x:_.x+w.x*i,y:_.y+w.y*i},M={x:(P.x+O.x)/2,y:(P.y+O.y)/2};const U=[P,M,O];P={x:E.x-w.x*n,y:E.y-w.y*n},O={x:_.x-w.x*o,y:_.y-w.y*o},M={x:(P.x+O.x)/2,y:(P.y+O.y)/2};const I=[O,M,P],L=b.makeline(I[2],U[0]),g=b.makeline(U[2],I[0]),z=[L,new $(U),g,new $(I)];return new ye(z)}const u=this.reduce(),a=u.length,s=[];let c=[],f,h=0,l=this.length();const d=typeof i<"u"&&typeof o<"u";function p(w,E,_,P,M){return function(O){const U=P/_,I=(P+M)/_,L=E-w;return b.map(O,0,1,w+U*L,w+I*L)}}u.forEach(function(w){const E=w.length();d?(s.push(w.scale(p(e,i,l,h,E))),c.push(w.scale(p(-n,-o,l,h,E)))):(s.push(w.scale(e)),c.push(w.scale(-n))),h+=E}),c=c.map(function(w){return f=w.points,f[3]?w.points=[f[3],f[2],f[1],f[0]]:w.points=[f[2],f[1],f[0]],w}).reverse();const y=s[0].points[0],k=s[a-1].points[s[a-1].points.length-1],C=c[a-1].points[c[a-1].points.length-1],m=c[0].points[0],T=b.makeline(C,y),A=b.makeline(k,m),v=[T].concat(s).concat([A]).concat(c);return new ye(v)}outlineshapes(e,n,i){n=n||e;const o=this.outline(e,n).curves,u=[];for(let a=1,s=o.length;a<s/2;a++){const c=b.makeshape(o[a],o[s-a],i);c.startcap.virtual=a>1,c.endcap.virtual=a<s/2-1,u.push(c)}return u}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof $&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=Ze(e.p1.x,e.p2.x),i=Ze(e.p1.y,e.p2.y),o=Xe(e.p1.x,e.p2.x),u=Xe(e.p1.y,e.p2.y);return b.roots(this.points,e).filter(a=>{var s=this.get(a);return b.between(s.x,n,o)&&b.between(s.y,i,u)})}selfintersects(e){const n=this.reduce(),i=n.length-2,o=[];for(let u=0,a,s,c;u<i;u++)s=n.slice(u,u+1),c=n.slice(u+2),a=this.curveintersects(s,c,e),o.push(...a);return o}curveintersects(e,n,i){const o=[];e.forEach(function(a){n.forEach(function(s){a.overlaps(s)&&o.push({left:a,right:s})})});let u=[];return o.forEach(function(a){const s=b.pairiteration(a.left,a.right,i);s.length>0&&(u=u.concat(s))}),u}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,o){const u=(o-i)/4,a=this.get(i+u),s=this.get(o-u),c=b.dist(e,n),f=b.dist(e,a),h=b.dist(e,s);return ge(f-c)+ge(h-c)}_iterate(e,n){let i=0,o=1,u;do{u=0,o=1;let a=this.get(i),s,c,f,h,l=!1,d=!1,p,y=o,k=1;do if(d=l,h=f,y=(i+o)/2,s=this.get(y),c=this.get(o),f=b.getccenter(a,s,c),f.interval={start:i,end:o},l=this._error(f,a,i,o)<=e,p=d&&!l,p||(k=o),l){if(o>=1){if(f.interval.end=k=1,h=f,o>1){let m={x:f.x+f.r*ft(f.e),y:f.y+f.r*ht(f.e)};f.e+=b.angle({x:f.x,y:f.y},m,this.get(1))}break}o=o+(o-i)/2}else o=y;while(!p&&u++<100);if(u>=100)break;h=h||f,n.push(h),i=k}while(o<1);return n}}function Re(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function pt(r){if(Array.isArray(r))return r}function yt(r){if(Array.isArray(r))return Re(r)}function mt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function vt(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,o,u,a,s=[],c=!0,f=!1;try{if(u=(n=n.call(r)).next,e!==0)for(;!(c=(i=u.call(n)).done)&&(s.push(i.value),s.length!==e);c=!0);}catch(h){f=!0,o=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(f)throw o}}return s}}function xt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wt(r,e){if(r==null)return{};var n,i,o=_t(r,e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(r);for(i=0;i<u.length;i++)n=u[i],e.includes(n)||{}.propertyIsEnumerable.call(r,n)&&(o[n]=r[n])}return o}function _t(r,e){if(r==null)return{};var n={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(e.includes(i))continue;n[i]=r[i]}return n}function kt(r,e){return pt(r)||vt(r,e)||ln(r,e)||xt()}function Ct(r){return yt(r)||mt(r)||ln(r)||bt()}function zt(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Pt(r){var e=zt(r,"string");return typeof e=="symbol"?e:e+""}function ln(r,e){if(r){if(typeof r=="string")return Re(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(r,e):void 0}}var Ot=(function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(s){return{keyAccessor:s,isProp:!(s instanceof Function)}}),u=r.reduce(function(s,c){var f=s,h=c;return o.forEach(function(l,d){var p=l.keyAccessor,y=l.isProp,k;if(y){var C=h,m=C[p],T=wt(C,[p].map(Pt));k=m,h=T}else k=p(h,d);d+1<o.length?(f.hasOwnProperty(k)||(f[k]={}),f=f[k]):n?(f.hasOwnProperty(k)||(f[k]=[]),f[k].push(h)):f[k]=h}),s},{});n instanceof Function&&(function s(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;f===o.length?Object.keys(c).forEach(function(h){return c[h]=n(c[h])}):Object.values(c).forEach(function(h){return s(h,f+1)})})(u);var a=u;return i&&(a=[],(function s(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];f.length===o.length?a.push({keys:f,vals:c}):Object.entries(c).forEach(function(h){var l=kt(h,2),d=l[0],p=l[1];return s(p,[].concat(Ct(f),[d]))})})(u),e instanceof Array&&e.length===0&&a.length===1&&(a[0].keys=[])),a});function Et(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=r:o.appendChild(document.createTextNode(r))}}var Dt=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;Et(Dt);function je(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function Mt(r){if(Array.isArray(r))return r}function Tt(r){if(Array.isArray(r))return je(r)}function Ye(r,e,n){if(cn())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var o=new(r.bind.apply(r,i));return o}function xe(r,e,n){return(e=It(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function cn(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cn=function(){return!!r})()}function At(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function St(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,o,u,a,s=[],c=!0,f=!1;try{if(u=(n=n.call(r)).next,e!==0)for(;!(c=(i=u.call(n)).done)&&(s.push(i.value),s.length!==e);c=!0);}catch(h){f=!0,o=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(f)throw o}}return s}}function Rt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ke(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),n.push.apply(n,i)}return n}function se(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ke(Object(n),!0).forEach(function(i){xe(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function me(r,e){return Mt(r)||St(r,e)||fn(r,e)||Rt()}function X(r){return Tt(r)||At(r)||fn(r)||jt()}function Ut(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function It(r){var e=Ut(r,"string");return typeof e=="symbol"?e:e+""}function Ue(r){"@babel/helpers - typeof";return Ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ue(r)}function fn(r,e){if(r){if(typeof r=="string")return je(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?je(r,e):void 0}}var Lt=Pn(vn);function Be(r,e,n){!e||typeof n!="string"||r.filter(function(i){return!i[n]}).forEach(function(i){i[n]=Lt(e(i))})}function Ft(r,e){var n=r.nodes,i=r.links,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=o.nodeFilter,a=u===void 0?function(){return!0}:u,s=o.onLoopError,c=s===void 0?function(p){throw"Invalid DAG structure! Found cycle in node path: ".concat(p.join(" -> "),".")}:s,f={};n.forEach(function(p){return f[e(p)]={data:p,out:[],depth:-1,skip:!a(p)}}),i.forEach(function(p){var y=p.source,k=p.target,C=v(y),m=v(k);if(!f.hasOwnProperty(C))throw"Missing source node with id: ".concat(C);if(!f.hasOwnProperty(m))throw"Missing target node with id: ".concat(m);var T=f[C],A=f[m];T.out.push(A);function v(w){return Ue(w)==="object"?e(w):w}});var h=[];d(Object.values(f));var l=Object.assign.apply(Object,[{}].concat(X(Object.entries(f).filter(function(p){var y=me(p,2),k=y[1];return!k.skip}).map(function(p){var y=me(p,2),k=y[0],C=y[1];return xe({},k,C.depth)}))));return l;function d(p){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,C=function(){var v=p[m];if(y.indexOf(v)!==-1){var w=[].concat(X(y.slice(y.indexOf(v))),[v]).map(function(E){return e(E.data)});return h.some(function(E){return E.length===w.length&&E.every(function(_,P){return _===w[P]})})||(h.push(w),c(w)),1}k>v.depth&&(v.depth=k,d(v.out,[].concat(X(y),[v]),k+(v.skip?0:1)))},m=0,T=p.length;m<T;m++)C()}}var Nt=2,W=function(e,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},Qe=function(e,n){if(!n.isShadow){var i=N(n.linkDirectionalParticles);n.graphData.links.forEach(function(o){var u=Math.round(Math.abs(i(o)));u?o.__photons=X(Array(u)).map(function(){return{}}):delete o.__photons})}},ke=tn({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1,Qe(e,n)}},dagMode:{onChange:function(e,n){!e&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:W},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:W},nodeColor:{default:"color",triggerUpdate:!1,onChange:W},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:W},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:W},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:W},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:W},linkColor:{default:"color",triggerUpdate:!1,onChange:W},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:W},linkWidth:{default:1,triggerUpdate:!1,onChange:W},linkCurvature:{default:0,triggerUpdate:!1,onChange:W},linkCanvasObject:{triggerUpdate:!1,onChange:W},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:W},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:W},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:W},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:W},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:Qe},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},linkDirectionalParticleCanvasObject:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,n,i){return i===void 0?e.forceLayout.force(n):(e.forceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){return!e.isShadow&&n(),o(),!e.isShadow&&u(),!e.isShadow&&a(),i(),this;function n(){e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick()))}function i(){var s=N(e.nodeVisibility),c=N(e.nodeVal),f=N(e.nodeColor),h=N(e.nodeCanvasObjectMode),l=e.ctx,d=e.isShadow/e.globalScale,p=e.graphData.nodes.filter(s);l.save(),p.forEach(function(y){var k=h(y);if(e.nodeCanvasObject&&(k==="before"||k==="replace")&&(e.nodeCanvasObject(y,l,e.globalScale),k==="replace")){l.restore();return}var C=Math.sqrt(Math.max(0,c(y)||1))*e.nodeRelSize+d;l.beginPath(),l.arc(y.x,y.y,C,0,2*Math.PI,!1),l.fillStyle=f(y)||"rgba(31, 120, 180, 0.92)",l.fill(),e.nodeCanvasObject&&k==="after"&&e.nodeCanvasObject(y,e.ctx,e.globalScale)}),l.restore()}function o(){var s=N(e.linkVisibility),c=N(e.linkColor),f=N(e.linkWidth),h=N(e.linkLineDash),l=N(e.linkCurvature),d=N(e.linkCanvasObjectMode),p=e.ctx,y=e.isShadow*2,k=e.graphData.links.filter(s);k.forEach(E);var C=[],m=[],T=k;if(e.linkCanvasObject){var A=[],v=[];k.forEach(function(_){return({before:C,after:m,replace:A}[d(_)]||v).push(_)}),T=[].concat(X(C),m,v),C=C.concat(A)}p.save(),C.forEach(function(_){return e.linkCanvasObject(_,p,e.globalScale)}),p.restore();var w=Ot(T,[c,f,h]);p.save(),Object.entries(w).forEach(function(_){var P=me(_,2),M=P[0],O=P[1],U=!M||M==="undefined"?"rgba(0,0,0,0.15)":M;Object.entries(O).forEach(function(I){var L=me(I,2),g=L[0],z=L[1],x=(g||1)/e.globalScale+y;Object.entries(z).forEach(function(D){var S=me(D,2);S[0];var R=S[1],j=h(R[0]);p.beginPath(),R.forEach(function(F){var G=F.source,V=F.target;if(!(!G||!V||!G.hasOwnProperty("x")||!V.hasOwnProperty("x"))){p.moveTo(G.x,G.y);var q=F.__controlPoints;q?p[q.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(p,X(q).concat([V.x,V.y])):p.lineTo(V.x,V.y)}}),p.strokeStyle=U,p.lineWidth=x,p.setLineDash(j||[]),p.stroke()})})}),p.restore(),p.save(),m.forEach(function(_){return e.linkCanvasObject(_,p,e.globalScale)}),p.restore();function E(_){var P=l(_);if(!P){_.__controlPoints=null;return}var M=_.source,O=_.target;if(!(!M||!O||!M.hasOwnProperty("x")||!O.hasOwnProperty("x"))){var U=Math.sqrt(Math.pow(O.x-M.x,2)+Math.pow(O.y-M.y,2));if(U>0){var I=Math.atan2(O.y-M.y,O.x-M.x),L=U*P,g={x:(M.x+O.x)/2+L*Math.cos(I-Math.PI/2),y:(M.y+O.y)/2+L*Math.sin(I-Math.PI/2)};_.__controlPoints=[g.x,g.y]}else{var z=P*70;_.__controlPoints=[O.x,O.y-z,O.x+z,O.y]}}}}function u(){var s=1.6,c=.2,f=N(e.linkDirectionalArrowLength),h=N(e.linkDirectionalArrowRelPos),l=N(e.linkVisibility),d=N(e.linkDirectionalArrowColor||e.linkColor),p=N(e.nodeVal),y=e.ctx;y.save(),e.graphData.links.filter(l).forEach(function(k){var C=f(k);if(!(!C||C<0)){var m=k.source,T=k.target;if(!(!m||!T||!m.hasOwnProperty("x")||!T.hasOwnProperty("x"))){var A=Math.sqrt(Math.max(0,p(m)||1))*e.nodeRelSize,v=Math.sqrt(Math.max(0,p(T)||1))*e.nodeRelSize,w=Math.min(1,Math.max(0,h(k))),E=d(k)||"rgba(0,0,0,0.28)",_=C/s/2,P=k.__controlPoints&&Ye($,[m.x,m.y].concat(X(k.__controlPoints),[T.x,T.y])),M=P?function(x){return P.get(x)}:function(x){return{x:m.x+(T.x-m.x)*x||0,y:m.y+(T.y-m.y)*x||0}},O=P?P.length():Math.sqrt(Math.pow(T.x-m.x,2)+Math.pow(T.y-m.y,2)),U=A+C+(O-A-v-C)*w,I=M(U/O),L=M((U-C)/O),g=M((U-C*(1-c))/O),z=Math.atan2(I.y-L.y,I.x-L.x)-Math.PI/2;y.beginPath(),y.moveTo(I.x,I.y),y.lineTo(L.x+_*Math.cos(z),L.y+_*Math.sin(z)),y.lineTo(g.x,g.y),y.lineTo(L.x-_*Math.cos(z),L.y-_*Math.sin(z)),y.fillStyle=E,y.fill()}}}),y.restore()}function a(){var s=N(e.linkDirectionalParticles),c=N(e.linkDirectionalParticleSpeed),f=N(e.linkDirectionalParticleOffset),h=N(e.linkDirectionalParticleWidth),l=N(e.linkVisibility),d=N(e.linkDirectionalParticleColor||e.linkColor),p=e.ctx;p.save(),e.graphData.links.filter(l).forEach(function(y){var k=s(y);if(!(!y.hasOwnProperty("__photons")||!y.__photons.length)){var C=y.source,m=y.target;if(!(!C||!m||!C.hasOwnProperty("x")||!m.hasOwnProperty("x"))){var T=c(y),A=Math.abs(f(y)),v=y.__photons||[],w=Math.max(0,h(y)/2)/Math.sqrt(e.globalScale),E=d(y)||"rgba(0,0,0,0.28)";p.fillStyle=E;var _=y.__controlPoints?Ye($,[C.x,C.y].concat(X(y.__controlPoints),[m.x,m.y])):null,P=0,M=!1;v.forEach(function(O){var U=!!O.__singleHop;if(O.hasOwnProperty("__progressRatio")||(O.__progressRatio=U?0:(P+A)/k),!U&&P++,O.__progressRatio+=T,O.__progressRatio>=1)if(!U)O.__progressRatio=O.__progressRatio%1;else{M=!0;return}var I=O.__progressRatio,L=_?_.get(I):{x:C.x+(m.x-C.x)*I||0,y:C.y+(m.y-C.y)*I||0};e.linkDirectionalParticleCanvasObject?e.linkDirectionalParticleCanvasObject(L.x,L.y,y,p,e.globalScale):(p.beginPath(),p.arc(L.x,L.y,w,0,2*Math.PI,!1),p.fill())}),M&&(y.__photons=y.__photons.filter(function(O){return!O.__singleHop||O.__progressRatio<=1}))}}}),p.restore()}},emitParticle:function(e,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:bn().force("link",wn()).force("charge",_n()).force("center",kn()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.ctx=e},update:function(e,n){e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&Be(e.graphData.nodes,N(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&Be(e.graphData.links,N(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach(function(d){d.source=d[e.linkSource],d.target=d[e.linkTarget]}),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var i=e.forceLayout.force("link");i&&i.id(function(d){return d[e.nodeId]}).links(e.graphData.links);var o=e.dagMode&&Ft(e.graphData,function(d){return d[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),u=Math.max.apply(Math,X(Object.values(o||[]))),a=e.dagLevelDistance||e.graphData.nodes.length/(u||1)*Nt*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(n.dagMode)){var s=["lr","rl"].includes(n.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(d){return delete d[s]})}if(["lr","rl","td","bu"].includes(e.dagMode)){var c=["rl","bu"].includes(e.dagMode),f=function(p){return(o[p[e.nodeId]]-u/2)*a*(c?-1:1)},h=["lr","rl"].includes(e.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(d){return d[h]=f(d)})}e.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?xn(function(d){var p=o[d[e.nodeId]]||-1;return(e.dagMode==="radialin"?u-p:p)*a}).strength(function(d){return e.dagNodeFilter(d)?1:0}):null);for(var l=0;l<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);l++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function hn(r,e){var n=r instanceof Array?r:[r],i=new e;return i._destructor&&i._destructor(),{linkProp:function(u){return{default:i[u](),onChange:function(s,c){n.forEach(function(f){return c[f][u](s)})},triggerUpdate:!1}},linkMethod:function(u){return function(a){for(var s=arguments.length,c=new Array(s>1?s-1:0),f=1;f<s;f++)c[f-1]=arguments[f];var h=[];return n.forEach(function(l){var d=a[l],p=d[u].apply(d,c);p!==d&&h.push(p)}),h.length?h[0]:this}}}}var Gt=800,$t=4,qt=5,dn=hn("forceGraph",ke),Vt=hn(["forceGraph","shadowGraph"],ke),Wt=Object.assign.apply(Object,X(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return xe({},r,dn.linkProp(r))})).concat(X(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return xe({},r,Vt.linkProp(r))})))),Ht=Object.assign.apply(Object,X(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return xe({},r,dn.linkMethod(r))})));function Te(r){if(r.canvas){var e=r.canvas.width,n=r.canvas.height;e===300&&n===150&&(e=n=0);var i=window.devicePixelRatio;e/=i,n/=i,[r.canvas,r.shadowCanvas].forEach(function(u){u.style.width="".concat(r.width,"px"),u.style.height="".concat(r.height,"px"),u.width=r.width*i,u.height=r.height*i,!e&&!n&&u.getContext("2d").scale(i,i)});var o=te(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-e)/2/o,(r.height-n)/2/o),r.needsRedraw=!0}}function gn(r){var e=window.devicePixelRatio;r.setTransform(e,0,0,e,0,0)}function Je(r,e,n){r.save(),gn(r),r.clearRect(0,0,e,n),r.restore()}var Zt=tn({props:se({width:{default:window.innerWidth,onChange:function(e,n){return Te(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,n){return Te(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){[e.nodes,e.links].every(function(o){return(o||[]).every(function(u){return!u.hasOwnProperty("__indexColor")})})&&n.colorTracker.reset(),[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach(i),n.forceGraph.graphData(e),n.shadowGraph.graphData(e);function i(o){var u=o.type,a=o.objs;a.filter(function(s){if(!s.hasOwnProperty("__indexColor"))return!0;var c=n.colorTracker.lookup(s.__indexColor);return!c||!c.hasOwnProperty("d")||c.d!==s}).forEach(function(s){s.__indexColor=n.colorTracker.register({type:u,d:s})})}},triggerUpdate:!1},backgroundColor:{onChange:function(e,n){n.canvas&&e&&(n.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,n){n.shadowGraph.nodeCanvasObject(e?function(i,o,u){return e(i,i.__indexColor,o,u)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,n){n.shadowGraph.linkCanvasObject(e?function(i,o,u){return e(i,i.__indexColor,o,u)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,n){n.zoom.scaleExtent([e,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},Wt),aliases:{stopAnimation:"pauseAnimation"},methods:se({graph2ScreenCoords:function(e,n,i){var o=te(e.canvas);return{x:n*o.k+o.x,y:i*o.k+o.y}},screen2GraphCoords:function(e,n,i){var o=te(e.canvas);return{x:(n-o.x)/o.k,y:(i-o.y)/o.k}},centerAt:function(e,n,i,o){if(!e.canvas)return null;if(n!==void 0||i!==void 0){var u=Object.assign({},n!==void 0?{x:n}:{},i!==void 0?{y:i}:{});return o?e.tweenGroup.add(new Ie(a()).to(u,o).easing(Le.Quadratic.Out).onUpdate(s).start()):s(u),this}return a();function a(){var c=te(e.canvas);return{x:(e.width/2-c.x)/c.k,y:(e.height/2-c.y)/c.k}}function s(c){var f=c.x,h=c.y;e.zoom.translateTo(e.zoom.__baseElem,f===void 0?a().x:f,h===void 0?a().y:h),e.needsRedraw=!0}},zoom:function(e,n,i){if(!e.canvas)return null;if(n!==void 0)return i?e.tweenGroup.add(new Ie({k:o()}).to({k:n},i).easing(Le.Quadratic.Out).onUpdate(function(a){var s=a.k;return u(s)}).start()):u(n),this;return o();function o(){return te(e.canvas).k}function u(a){e.zoom.scaleTo(e.zoom.__baseElem,a),e.needsRedraw=!0}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,o=arguments.length,u=new Array(o>3?o-3:0),a=3;a<o;a++)u[a-3]=arguments[a];var s=this.getGraphBbox.apply(this,u);if(s){var c={x:(s.x[0]+s.x[1])/2,y:(s.y[0]+s.y[1])/2},f=Math.max(1e-12,Math.min(1e12,(e.width-i*2)/(s.x[1]-s.x[0]),(e.height-i*2)/(s.y[1]-s.y[0])));this.centerAt(c.x,c.y,n),this.zoom(f,n)}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=N(e.nodeVal),o=function(s){return Math.sqrt(Math.max(0,i(s)||1))*e.nodeRelSize},u=e.graphData.nodes.filter(n).map(function(a){return{x:a.x,y:a.y,r:o(a)}});return u.length?{x:[Fe(u,function(a){return a.x-a.r}),Ne(u,function(a){return a.x+a.r})],y:[Fe(u,function(a){return a.y-a.r}),Ne(u,function(a){return a.y+a.r})]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},Ht),stateInit:function(){return{lastSetZoom:1,zoom:Vn(),forceGraph:new ke,shadowGraph:new ke().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new ut,tweenGroup:new zn}},init:function(e,n){var i=this;e.innerHTML="";var o=document.createElement("div");o.classList.add("force-graph-container"),o.style.position="relative",e.appendChild(o),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),o.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var u=n.canvas.getContext("2d"),a=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),s={x:-1e12,y:-1e12},c=function(){var l=null,d=window.devicePixelRatio,p=s.x>0&&s.y>0?a.getImageData(s.x*d,s.y*d,1,1):null;return p&&(l=n.colorTracker.lookup(p.data)),l};B(n.canvas).call(Sn().subject(function(){if(!n.enableNodeDrag)return null;var h=c();return h&&h.type==="Node"?h.d:null}).on("start",function(h){var l=h.subject;l.__initialDragPos={x:l.x,y:l.y,fx:l.fx,fy:l.fy},h.active||(l.fx=l.x,l.fy=l.y),n.canvas.classList.add("grabbable")}).on("drag",function(h){var l=h.subject,d=l.__initialDragPos,p=h,y=te(n.canvas).k,k={x:d.x+(p.x-d.x)/y-l.x,y:d.y+(p.y-d.y)/y-l.y};["x","y"].forEach(function(C){return l["f".concat(C)]=l[C]=d[C]+(p[C]-d[C])/y}),!(!l.__dragged&&qt>=Math.sqrt(On(["x","y"].map(function(C){return Math.pow(h[C]-d[C],2)}))))&&(n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,l.__dragged=!0,n.onNodeDrag(l,k))}).on("end",function(h){var l=h.subject,d=l.__initialDragPos,p={x:l.x-d.x,y:l.y-d.y};d.fx===void 0&&(l.fx=void 0),d.fy===void 0&&(l.fy=void 0),delete l.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,l.__dragged&&(delete l.__dragged,n.onNodeDragEnd(l,p))})),n.zoom(n.zoom.__baseElem=B(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter(function(h){return!h.button&&n.enableZoomPanInteraction&&(h.type!=="wheel"||N(n.enableZoomInteraction)(h))&&(h.type==="wheel"||N(n.enablePanInteraction)(h))}).on("zoom",function(h){var l=h.transform;[u,a].forEach(function(d){gn(d),d.translate(l.x,l.y),d.scale(l.k,l.k)}),n.isPointerDragging=!0,n.onZoom&&n.onZoom(se(se({},l),i.centerAt())),n.needsRedraw=!0}).on("end",function(h){n.isPointerDragging=!1,n.onZoomEnd&&n.onZoomEnd(se(se({},h.transform),i.centerAt()))}),Te(n),n.forceGraph.onNeedsRedraw(function(){return n.needsRedraw=!0}).onFinishUpdate(function(){te(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=$t/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)}),n.tooltip=new Cn(o),["pointermove","pointerdown"].forEach(function(h){return o.addEventListener(h,function(l){h==="pointerdown"&&(n.isPointerPressed=!0,n.pointerDownEvent=l),!n.isPointerDragging&&l.type==="pointermove"&&n.onBackgroundClick&&(l.pressure>0||n.isPointerPressed)&&(l.pointerType==="mouse"||l.movementX===void 0||[l.movementX,l.movementY].some(function(y){return Math.abs(y)>1}))&&(n.isPointerDragging=!0);var d=p(o);s.x=l.pageX-d.left,s.y=l.pageY-d.top;function p(y){var k=y.getBoundingClientRect(),C=window.pageXOffset||document.documentElement.scrollLeft,m=window.pageYOffset||document.documentElement.scrollTop;return{top:k.top+m,left:k.left+C}}},{passive:!0})}),o.addEventListener("pointerup",function(h){if(n.isPointerPressed){if(n.isPointerPressed=!1,n.isPointerDragging){n.isPointerDragging=!1;return}var l=[h,n.pointerDownEvent];requestAnimationFrame(function(){if(h.button===0)if(n.hoverObj){var d=n["on".concat(n.hoverObj.type,"Click")];d&&d.apply(void 0,[n.hoverObj.d].concat(l))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,l);if(h.button===2)if(n.hoverObj){var p=n["on".concat(n.hoverObj.type,"RightClick")];p&&p.apply(void 0,[n.hoverObj.d].concat(l))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,l)})}},{passive:!0}),o.addEventListener("contextmenu",function(h){return!n.onBackgroundRightClick&&!n.onNodeRightClick&&!n.onLinkRightClick?!0:(h.preventDefault(),!1)}),n.forceGraph(u),n.shadowGraph(a);var f=Hn(function(){Je(a,n.width,n.height),n.shadowGraph.linkWidth(function(l){return N(n.linkWidth)(l)+n.linkHoverPrecision});var h=te(n.canvas);n.shadowGraph.globalScale(h.k).tickFrame()},Gt);n.flushShadowCanvas=f.flush,(this._animationCycle=function h(){var l=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some(function(A){return A.__photons&&A.__photons.length});if(n.needsRedraw=!1,n.enablePointerInteraction){var d=n.isPointerDragging?null:c();if(d!==n.hoverObj){var p=n.hoverObj,y=p?p.type:null,k=d?d.type:null;if(y&&y!==k){var C=n["on".concat(y,"Hover")];C&&C(null,p.d)}if(k){var m=n["on".concat(k,"Hover")];m&&m(d.d,y===k?p.d:null)}n.tooltip.content(d&&N(n["".concat(d.type.toLowerCase(),"Label")])(d.d)||null),n.canvas.classList[d&&n["on".concat(k,"Click")]||!d&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=d}l&&f()}if(l){Je(u,n.width,n.height);var T=te(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(u,T),n.forceGraph.globalScale(T).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(u,T)}n.tweenGroup.update(),n.animationFrameRequestId=requestAnimationFrame(h)})()},update:function(e){}});const ir=(r,e,n,i,o,u,a,s)=>{const c=u/2,f=Math.PI*c*c,h=r.map(p=>({...p,val:f}));let l=o;l||(l=new Zt(i));const d=36*a;return l.nodeId("id").nodeLabel("label").nodeColor("color").nodeVal("val").nodeRelSize(1).linkColor("color").linkWidth(2).graphData({nodes:h,links:e}),s?l.nodeCanvasObject((p,y,k)=>{const C=String(p.label),m=d/k;y.font=`${m}px ${Ge("--bs-font-sans-serif")}`,y.textAlign="center",y.textBaseline="top",y.fillStyle=Ge("--bs-body-color"),typeof p.x=="number"&&typeof p.y=="number"&&y.fillText(C,p.x,p.y+c+2)}).nodeCanvasObjectMode(()=>"after"):l.nodeCanvasObject(()=>{}).nodeCanvasObjectMode(()=>"after"),l};export{ir as default};
